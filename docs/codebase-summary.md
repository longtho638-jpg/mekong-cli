# Codebase Summary
> Updated: January 20, 2026

## Architecture Overview

AgencyOS uses a **Domain-Driven Design (DDD)** approach with modular architecture. All files comply with 200-line limit.

### Antigravity Core (`antigravity/core/`)

| Module | Purpose | Structure |
| :--- | :--- | :--- |
| **ab_testing** | A/B Testing Engine | `engine.py`, `analysis.py`, `reporting.py`, `time_utils.py` |
| **agent_orchestrator** | Agent Coordination | `engine.py`, `analytics.py`, `reporting.py` |
| **agent_swarm** | Multi-Agent Systems | `engine.py`, `registry.py`, `task_manager.py`, `shortcuts.py` |
| **algorithm** | Algorithm Framework | `core.py`, `confidence.py`, `strategies.py` |
| **cashflow_engine** | Cash Flow Management | `engine.py`, `analytics.py`, `dashboard.py`, `persistence.py` |
| **client_magnet** | Lead Generation | `engine.py`, `analytics.py`, `persistence.py`, `scoring.py` |
| **code_guardian** | Code Quality | `guardian.py`, `monitor.py`, `rollback.py`, `scanner.py` |
| **content_factory** | Content Generation | `engine.py`, `ideation.py`, `production.py`, `scheduling.py` |
| **ml/models** | ML Models | `base.py`, `classifiers.py`, `regressors.py`, `utils.py`, `config.py` |
| **moat_engine** | Competitive Moat | `engine.py`, `dashboard.py`, `definitions.py`, `persistence.py`, `strategy.py` |
| **money_maker** | Revenue Generation | `engine.py`, `governance.py`, `qualification.py`, `quoting.py` |
| **proposal_generator** | Proposal Creation | `engine.py`, `analytics.py`, `builder.py`, `persistence.py` |
| **revenue/ai** | Revenue AI | `engine.py`, `forecasting.py`, `goals.py`, `reporting.py` |
| **mixins** | Reusable Behaviors | StatsMixin, PersistenceMixin |
| **patterns** | Shared Patterns | singleton_factory, BasePersistence |
| **types** | Type Definitions | TypedDict, Protocol definitions |

### Infrastructure (`antigravity/infrastructure/`)

| Module | Purpose | Structure |
| :--- | :--- | :--- |
| **opentelemetry/tracer** | Tracing | `base.py`, `context.py`, `decorators.py`, `spans.py` |
| **opentelemetry/processors** | Span Processing | `base.py`, `batch.py`, `filtering.py`, `sampling.py` |
| **opentelemetry/exporters** | Data Export | `base.py`, `console.py`, `otlp.py`, `jaeger.py` |
| **scale** | Scaling Infrastructure | `base.py`, `horizontal.py`, `vertical.py`, `metrics.py` |

### CLI Layer (`cli/` and `antigravity/cli/`)

| Module | Purpose |
| :--- | :--- |
| **cli/entrypoint.py** | Main CLI entry point |
| **cli/commands/** | Command modules (dev, mcp, revenue, strategy, utility) |
| **antigravity/cli/app.py** | CLI application factory |
| **antigravity/cli/commands.py** | Command definitions |
| **antigravity/cli/utils.py** | CLI utilities |

### Interfaces

*   **CLI**: Built with **Typer**. Entry: `main.py` -> `cli/entrypoint.py`
*   **Backend**: Built with **FastAPI**. Entry: `backend/main.py`

### Key Workflows

1.  **Revenue Autopilot**: `core.automation.autopilot` - daily revenue/lead checks
2.  **Hybrid Routing**: `core.ai.hybrid_router` - AI model optimization
3.  **Agent Orchestration**: `core.agent_orchestrator` - markdown-defined agents

### Code Quality Metrics

| Metric | Value |
| :--- | :--- |
| Max file lines | 200 |
| Type coverage | High (TypedDict/Protocol) |
| Test coverage | 100% pass rate |

---
*Generated by AgencyOS Refactoring Engine - January 20, 2026*